<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Draw App Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: system-ui,sans-serif; background:#fff; margin:0; }
    .controls { max-width:600px; margin:32px auto; }
    .winner-full {
      display: none;
      position:fixed;top:0;left:0;width:100vw;height:100vh;
      background:#fff;z-index:100;
      justify-content:center;align-items:center;flex-direction:column;
    }
    .winner-banner {
      min-width:260px;max-width:90vw;padding:2em 1.5em;background:#fff;border-radius:25px;
      box-shadow:0 6px 40px #0002;display:flex;flex-direction:column;align-items:center;position:relative;
    }
    .winner-modal-title { font-size:2rem;font-weight:bold;margin-bottom:10px;text-align:center; }
    .winner-modal-label { font-size:1.2rem;margin-bottom:6px;color:#666;text-align:center; }
    .winner-modal-name { font-size:2.5rem;font-weight:bold;text-align:center;margin-bottom:4px; }
    .winner-back-btn { position:absolute;top:-40px;right:0;background:#111;color:#fff;border:none;border-radius:16px;font-size:1rem;padding:7px 18px;z-index:110;cursor:pointer; }
    .redraw-btn {
      position:fixed;right:24px;bottom:24px;z-index:130;background:#111;color:#fff;border:none;border-radius:50%;
      width:48px;height:48px;opacity:.3;box-shadow:0 2px 10px #0002;font-size:1.7rem;display:flex;align-items:center;justify-content:center;cursor:pointer;
      transition:opacity .2s,background .3s;outline:none;
    }
    .redraw-btn:hover { opacity:0.7;background:#222; }
  </style>
</head>
<body>
  <div class="controls">
    <label>Page Title:
      <select id="title-select">
        <option value="0">No Title</option>
        <option value="1">Test Draw</option>
      </select>
    </label>
    <br><br>
    <textarea id="name-list" rows="3" style="width:100%;">Alice
Bob
Charlie</textarea><br>
    <button id="start-btn">Start</button>
  </div>
  <div id="winner-full" class="winner-full"></div>
  <button id="redraw-btn" class="redraw-btn" title="Redraw" style="display:none;">&#8635;</button>
  <script>
    // --- CONFIG ---
    const TITLE_OPTIONS = ["No Title","Test Draw"];
    // --- DOM ---
    const $titleSelect = document.getElementById("title-select");
    const $nameList = document.getElementById("name-list");
    const $start = document.getElementById("start-btn");
    const $winnerFull = document.getElementById("winner-full");
    const $redraw = document.getElementById("redraw-btn");
    // --- STATE ---
    let names = [];
    let winner = null, lastWinner = null, titleIdx = 0;

    function syncNamesFromTextarea() {
      names = $nameList.value.split("\n").map(x=>x.trim()).filter(x=>x);
    }
    function pickWinner() {
      if (names.length < 2) { alert("2+ names required"); return; }
      winner = names[Math.floor(Math.random()*names.length)];
      lastWinner = winner;
      $winnerFull.innerHTML = "";
      const $banner = document.createElement("div");
      $banner.className = "winner-banner";
      if(titleIdx>0){
        const $t=document.createElement("div");$t.className="winner-modal-title";$t.textContent=TITLE_OPTIONS[titleIdx];$banner.appendChild($t);
      }
      const $l=document.createElement("div");$l.className="winner-modal-label";$l.textContent="Winner";$banner.appendChild($l);
      const $n=document.createElement("div");$n.className="winner-modal-name";$n.textContent=winner;$banner.appendChild($n);
      const $back=document.createElement("button");$back.className="winner-back-btn";$back.textContent="Back";
      $back.onclick=()=>{$winnerFull.style.display="none";$redraw.style.display="none";};
      $banner.appendChild($back);
      $winnerFull.appendChild($banner);
      // THE KEY: set display = "flex" for flexbox!
      $winnerFull.style.display = "flex";
      $redraw.style.display = "";
      // Allow clicking outside to close
      $winnerFull.onclick = function(e) {
        if (e.target === $winnerFull) {
          $winnerFull.style.display = "none";
          $redraw.style.display = "none";
        }
      };
    }
    function redrawWinner() {
      if(!lastWinner) return;
      names = names.filter(n=>n!==lastWinner);
      $nameList.value = names.join("\n");
      if(names.length < 1) { alert("No more names left"); $winnerFull.style.display="none"; $redraw.style.display="none"; return; }
      $winnerFull.style.display="none";
      setTimeout(() => pickWinner(), 250);
    }
    $titleSelect.onchange = () => titleIdx = parseInt($titleSelect.value);
    $nameList.oninput = syncNamesFromTextarea;
    $start.onclick = () => { syncNamesFromTextarea(); pickWinner(); };
    $redraw.onclick = redrawWinner;
    // --- INIT ---
    syncNamesFromTextarea();
  </script>
</body>
</html>
